# μΈκ°• λ©”λ¨

# μ„Ήμ…2,3. μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ μ΄ν•΄
!! 01_01. μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ μ΄ν•΄_DIPμ„λ°μ κ²½μ° ν΄λ” μ°Έκ³ 
## Test μ½”λ“
### @Test
- javaμ½”λ“λ” λ“±λ΅λ κ°’κ³Ό λ‹¤λ¥Όλ• κ²°κ³Όλ¥Ό λμΌλ΅ ν™•μΈν•  μ λ°–μ— μ—†μ
- Test ν΄λμ¤λ¥Ό ν†µν•΄ κ°’μ μ ν¨μ„± κ²€μ‚¬λ¥Ό μ‰½κ²ν•  μ μμ
- Ctrl+Shift+Tλ΅ ν•΄λ‹Ή ν΄λμ¤μ Test ν΄λμ¤ μƒμ„± κ°€λ¥
    ```java
    import org.junit.jupiter.api.Test;
    Assertions.assertThat(κ°’).isEqualTo(κ°’);
    ```
- μ¤λ¥κ°€ μ—†λ” κ²½μ° "Process finished with exit code 0"

- μ¤λ¥ λλ” μ„±κ³µμ— λ©”μ„Έμ§€ μ¶”κ°€ μ‹ @DisplayName μ‚¬μ©
![alt text](image.png)

- Assrtionsλ” static import ν•λ” κ²ƒμ΄ μΆ‹μ
![alt text](image-1.png)

## interfaceλ¥Ό λ§λ“λ” μ΄μ λ¥Ό λ“λ””μ–΄ μ΄ν•΄ν–λ‹¤!
### javaλ¥Ό ν•λ©° λ“¤μ—λ μλ¬Έ: λ³€μλ§ μ„ μ–Έλ ν΄λμ¤λ‚ μΈν„°νμ΄μ¤λ¥Ό μ™ κµ³μ΄ λ§λ“¤κΉ?
#### ν΄λμ¤λ” λ―Έλ‹ ν”„λ΅μ νΈλ¥Ό ν†µν•΄ μλ¬Έ ν•΄κ²°
    DBμ—μ„ μ •λ³΄λ¥Ό κ°€μ Έμ¬ λ•λ§λ‹¤ μƒλ΅μ΄ λ³€μμ— κ°’μ„ μ €μ¥ν•  μ μ—†μΌλ‹ κ°’μ„ λ°›λ” setter, μ €μ¥λ κ°’μ„ λ¶λ¬μ¤λ” getterκ°€ ν•„μ”ν–μ
#### κ°•μλ¥Ό ν†µν•΄ μΈν„°νμ΄μ¤ μλ¬Έ ν•΄κ²°
    μ—­ν• μ΄ μ •ν•΄μ Έμμ§€λ§(VIPκ³ κ°μ€ ν• μΈν•΄μ¤) κµ¬ν„μ΄ λ‹¬λΌμ§ κ²½μ°(κ³ μ •ν• μΈ β†’ λΉ„μ¨ν• μΈ) λ©”μ†λ“ μμ²΄λ¥Ό λ³€κ²½ν•μ§€ μ•κ³  ν΄λμ¤ λ…λ§ λ³€κ²½ν•΄μ£Όλ©΄ λ¨
#### μΈν„°νμ΄μ¤μ™€ 2κ°μ κµ¬ν„ κ°μ²΄
![alt text](image-4.png)
#### κµ¬ν„μ΄ λ‹¬λΌμ Έ ν΄λμ¤λ§ λ³€λ™
![alt text](image-3.png)

## but ν•΄λ‹Ή μ½”λ“λ” DIPλ¥Ό μ„λ°ν•¨
- DIP: μ¶”μƒ ν΄λμ¤μ—λ§ μμ΅΄ν•΄μ•Όν•¨
    - ν„μ¬ μ½”λ“: μ£Όλ¬Έμ„λΉ„μ¤ ν΄λΌμ΄μ–ΈνΈ(orderServiceImpl) β† μ¶”μƒμΈν„°νμ΄μ¤(DiscountPolicy) β† κµ¬μ²΄(κµ¬ν„)ν΄λμ¤(FixDiscountPolicy, RateDiscountPolicy) κΉμ§€ μμ΅΄

    ```java
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy(); κ³ μ •ν• μΈ μ •μ±…μΌ κ²½μ°
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();  //ν• μΈμ •μ±… λ³€λ™(%)
                //μ¶”μƒμ—λ„ μμ΅΄ν•κ³                       κµ¬μ²΄ ν΄λμ¤λ„ μμ΅΄ν•΄λ²„λ¦Ό β†’ DIPμ„λ°! (μ¶”μƒλ§ μμ΅΄ν•΄μ•Ό ν•¨)
    ```

- κ°λ°©-νμ‡„ μ›μΉ™(OCP, Open-Closed Principle): μ†ν”„νΈμ›¨μ–΄ κ°μ²΄(ν΄λμ¤, λ¨λ“, ν•¨μ λ“±λ“±)λ” ν™•μ¥μ— λ€ν•΄ μ—΄λ ¤ μμ–΄μ•Ό ν•κ³ , μμ •μ— λ€ν•΄μ„λ” λ‹«ν€ μμ–΄μ•Ό ν•λ‹¤
    - κµ¬μ²΄ ν΄λμ¤λ¥Ό λ³€κ²½ν•  λ• ν΄λΌμ΄μ–ΈνΈ(OrderServiceImpl)μ μ†μ¤ μ½”λ“λ„ λ³€κ²½ν•΄μ•Όν•λ―€μ¤ OCP μ„λ°
- private DiscountPolicy discountPolicy;λ΅ μΈν„°νμ΄μ¤λ§ μ •μν•λ” κ²½μ° <span style="color:red;">NullPointerException</span> μ—λ¬ λ°μƒ!

#### ν•΄κ²°λ°©μ•
    π’΅λ„κµ°κ°€ ν΄λΌμ΄μ–ΈνΈμΈ OrderServiceImplμ— DiscountPolicyμ κµ¬ν„ κ°μ²΄λ¥Ό λ€μ‹  μƒμ„±ν•κ³  μ£Όμ…ν•΄μ•Ό ν•¨

## κ΄€μ‹¬μ‚¬ λ¶„λ¦¬
### AppConfig λ“±μ¥
- μ• ν”λ¦¬μΌ€μ΄μ…μ μ „μ²΄ λ™μ‘ λ°©μ‹μ„ κµ¬μ„±(config)ν•κΈ° μ„ν•΄, <span style="font-weight:bold;">κµ¬ν„ κ°μ²΄</span>λ¥Ό μƒμ„±ν•κ³ , <span style="font-weight:bold;">μ—°κ²°</span>ν•λ” μ±…μ„μ„ κ°€μ§€λ” λ³„λ„μ μ„¤μ • ν΄λμ¤

-  AppConfigλ” μƒμ„±ν• κ°μ²΄ μΈμ¤ν„΄μ¤μ μ°Έμ΅°(λ νΌλ°μ¤)λ¥Ό <span style="font-weight:bold;">μƒμ„±μλ¥Ό ν†µν•΄μ„ μ£Όμ…(μ—°κ²°)</span>ν•΄μ¤

### μƒμ„±μ μ£Όμ…
- MemberServiceImplμ—μ„ μ¶”μƒ ν΄λμ¤λ§ μ‚¬μ©ν•κ³ , AppConfigμ—μ„ κµ¬μ²΄ ν΄λμ¤λ¥Ό λ‹΄λ‹Ήν•λ„λ΅ λ³€κ²½
    ![alt text](image-5.png)

- OrderServiveImlλ„ 2κ°μ μ¶”μƒ ν΄λμ¤(MemberRepository, DiscountPolicy)λ§ μ‚¬μ©
    ![alt text](image-6.png)

> μ„¤κ³„ λ³€κ²½μΌλ΅ ImPlμ΄ κµ¬ν„ κ°μ²΄μ— μμ΅΄ν•μ§€ μ•κ² λ¨
- μμ΅΄κ΄€κ³„μ— λ€ν• κ³ λ―Όμ€ μ™Έλ¶€μ— λ§΅κΈ°κ³  <span style="font-weight:bold;">μ‹¤ν–‰μ—λ§ μ§‘μ¤‘</span>ν•λ©΄ λ¨!
    ![alt text](image-7.png)
    - DIP μ™„μ„±! κ΄€μ‹¬μ‚¬κ°€ λ¶„λ¦¬λ¨
    - ν΄λΌμ΄μ–ΈνΈμΈ 'memberImpl' μ…μ¥μ—μ„ λ³΄λ©΄ μμ΅΄κ΄€κ³„λ¥Ό λ§μΉ μ™Έλ¶€μ—μ„ μ£Όμ…ν•΄μ£Όλ” κ²ƒ κ°™λ‹¤κ³  ν•΄μ„ DI(Dependency Injection, μμ΅΄κ΄€κ³„ μ£Όμ…(μμ΅΄μ„± μ£Όμ…))μ΄λΌκ³  ν•¨

### μ‹¤ν–‰
- Implμ„ λ¶λ¬μ™€ μ‹¤ν–‰ν•λ κΈ°μ΅΄ μ½”λ“μ—μ„ AppConfigλ¥Ό λ¶λ¬μ™€ κ°’μ„ μ£Όμ…λ°›λ„λ΅ λ³€κ²½
    ![alt text](image-8.png)
    ![alt text](image-9.png)

#### Test λ³€κ²½
- Testλ„ Implμ΄ μ•„λ‹ AppConfigλ¥Ό μ°Έμ΅°ν•λ„λ΅ λ³€κ²½
- @BeforeEach μ‚¬μ©
    ![alt text](image-10.png)
    ![alt text](image-11.png)

### AppConfigμ—μ„ μ—­ν• μ— λ€ν• κµ¬ν„μ„ λ…ν™•ν κµ¬λ¶„ν•  μ μλ„λ΅ λ³€κ²½
- κ°μ²΄λ΅ λ¶λ¬μ¤λ κ²ƒμ„ λ³„λ„μ λ©”μ†λ“λ΅ λ¶„λ¦¬ν•΄μ„ μ½(λ‹¨μ¶•ν‚¤: Ctrl+Alt+M)
    - β†’λ©”μ†λ“ λ…μ„ λ³΄λ©΄ μ—­ν• μ΄ λ‹¤ λ“¤μ–΄λ‚¨!
    ![alt text](image-12.png)

- 4κ°μ λ©”μ†λ“κ°€ μκ³  κ° λ©”μ†λ“ λ…μΌλ΅ μ—­ν• μ„ μ• μ μμ
    1. MemberServiceλ” MemberServiceImplλ¥Ό μ‚¬μ©ν•¨μ„ μ• μ μμ
    2. λ§μ•½ MemoryMemberRepositoryκ°€ μκΈ° μμ‹ μ΄ μ•„λ‹ DBλ¥Ό μ‚¬μ©ν•  κ²½μ° 2λ²μ return κ°μ²΄λ§ λ³€κ²½ν•΄μ£Όλ©΄ λ¨!
    ![alt text](image-13.png)

<h3 style="color:yellow; background-color:black;">β­μ΄μ  μ‚¬μ© μμ—­μ μ½”λ“λ” κ±΄λ“λ¦¬μ§€ μ•κ³  κµ¬μ„± μμ—­μ μ½”λ“(AppConfig)λ§ κ³ μΉλ©΄ λ¨!β­</h3>
![alt text](image-14.png)
- ν• μΈ μ •μ±…μ„ λ³€κ²½ν•  κ²½μ° AppConfigμ DiscountPolicyλ§ λ³€κ²½ν•΄μ£Όλ©΄ λ¨
![alt text](image-15.png)

# μ μ–΄μ μ—­μ „ IoC(Inversion of Control)
- λ‚΄κ°€ μ½”λ“λ¥Ό νΈμ¶ν•λ” κ²ƒμ΄ μ•„λ‹ ν”„λ μ„μ›ν¬ κ°™μ€ μ™Έλ¶€μ—μ„ κ΄€λ¦¬ν•κ³  νΈμ¶ν•λ” κ²ƒ

> ν”„λ μ„μ›ν¬ vs λΌμ΄λΈλ¬λ¦¬
    - ν”„λ μ„μ›ν¬κ°€ λ‚΄κ°€ μ‘μ„±ν• μ½”λ“λ¥Ό μ μ–΄ν•κ³ , λ€μ‹  μ‹¤ν–‰ν•λ©΄ κ·Έκ²ƒμ€ ν”„λ μ„μ›ν¬κ°€ λ§λ‹¤. (JUnit)
    - λ°λ©΄μ— λ‚΄κ°€ μ‘μ„±ν• μ½”λ“κ°€ μ§μ ‘ μ μ–΄μ νλ¦„μ„ λ‹΄λ‹Ήν•λ‹¤λ©΄ κ·Έκ²ƒμ€ ν”„λ μ„μ›ν¬κ°€ μ•„λ‹λΌ λΌμ΄λΈλ¬λ¦¬λ‹¤.

# μμ΅΄κ΄€κ³„ μ£Όμ… DI
- μ• ν”λ¦¬μΌ€μ΄μ… <strong>μ‹¤ν–‰ μ‹μ (λ°νƒ€μ„)</strong>μ— μ™Έλ¶€μ—μ„ μ‹¤μ  κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  ν΄λΌμ΄μ–ΈνΈμ— μ „λ‹¬ν•΄μ„ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ μ‹¤μ  μμ΅΄κ΄€κ³„κ°€ μ—°κ²° λλ” κ²ƒμ„ <strong>μμ΅΄κ΄€κ³„ μ£Όμ…</strong>μ΄λΌ ν•λ‹¤